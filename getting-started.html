<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 | Generated by Apache Maven Doxia at Oct 18, 2012
 | Rendered using Apache Maven Fluido Skin 1.2.2
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>99soft :: Rocoto - Home</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido.min.js"></script>

    
      <meta name="author" content="The 99 Software Foundation" />
    <meta name="Date-Revision-yyyymmdd" content="20121018" />
    <meta http-equiv="Content-Language" content="en" />
            </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/99soft/rocoto">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 100;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="index.html" id="bannerLeft">
                                                                                                <img src="images/logo.png"  alt="Add some spice to Google Guice through configuration files!"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 18 October 2012</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 6.2</li>
                      
                
                    
      
                            </ul>
      </div>

            <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
                    
                                    <h3>99soft :: Rocoto</h3>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Home">Home</a>
            </li>
                  <li class="none">
            <strong>Getting started</strong>
          </li>
                  <li class="none">
                          <a href="configuration.html" title="Configuration">Configuration</a>
            </li>
                  <li class="none">
                          <a href="converters.html" title="Converters">Converters</a>
            </li>
          </ul>
                        <h3>External Links</h3>
                  <ul>
                  <li class="none">
                          <a href="https://github.com/99soft/Rocoto" class="externalLink" title="Project Page">Project Page</a>
            </li>
                  <li class="none">
                          <a href="http://code.google.com/p/google-guice/" class="externalLink" title="Google Guice">Google Guice</a>
            </li>
          </ul>
                        <h3>99soft</h3>
                  <ul>
                  <li class="none">
                          <a href="../" title="Home">Home</a>
            </li>
                                                                                      <li class="collapsed">
                          <a href="../maven.html" title="Apache Maven Plugins">Apache Maven Plugins</a>
                  </li>
                                                                                                                                            <li class="collapsed">
                          <a href="../commons.html" title="Common tools">Common tools</a>
                  </li>
                                                                                                                                                                                <li class="collapsed">
                          <a href="../guice.html" title="Google Guice Integrations">Google Guice Integrations</a>
                  </li>
                                                                                                        <li class="collapsed">
                          <a href="../semweb.html" title="Semantic Web">Semantic Web</a>
                  </li>
          </ul>
                        <h3>General Information</h3>
                  <ul>
                  <li class="none">
                          <a href="../volunteering.html" title="Volunteering">Volunteering</a>
            </li>
                  <li class="none">
                          <a href="../patches.html" title="Contributing Patches">Contributing Patches</a>
            </li>
                  <li class="none">
                          <a href="../getinvolved.html" title="Get Involved">Get Involved</a>
            </li>
          </ul>
                      
                    
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
        <div id="bodyColumn"  class="span10" >
                                  
            <!--  --><!-- Copyright 2009-2012 The 99 Software Foundation --><!--  --><!-- Licensed under the Apache License, Version 2.0 (the "License"); --><!-- you may not use this file except in compliance with the License. --><!-- You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, software --><!-- distributed under the License is distributed on an "AS IS" BASIS, --><!-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. --><!-- See the License for the specific language governing permissions and --><!-- limitations under the License. --><!--  --><div class="section"><h2>Rocoto getting started<a name="Rocoto_getting_started"></a></h2><p>The <i>Rocoto</i> library is a small <i>Google Guice</i> extension that allows expanding <tt>com.google.inject.name.Names</tt> variables. That means that users can define properties with placeholders and let <i>Guice</i> resolve them to be injected with replaced values.</p><p>Users have just to invoke the <tt>org.nnsoft.guice.rocoto.Rocoto.expandVariables</tt> method grouping the <tt>Module</tt>s where properties have been bound, like in the sample below:</p><div class="source"><pre class="prettyprint">import com.google.inject.Guice;
import com.google.inject.Injector;
import com.google.inject.name.Names;

import org.nnsoft.guice.rocoto.Rocoto;

...

Injector injector = Guice.createInjector( Rocoto.expandVariables( new AbstractModule()
        {

            @Override
            protected void configure()
            {
                Properties properties = new Properties();
                properties.put( &quot;JDBC.host&quot;, &quot;localhost&quot; );
                properties.put( &quot;JDBC.port&quot;, &quot;3306&quot; );
                properties.put( &quot;JDBC.schema&quot;, &quot;test&quot; );
                ...

                Names.bindProperties( binder(), properties );
            }

        }, new AbstractModule()
        {

            @Override
            protected void configure()
            {
                bindConstant()
                    .annotatedWith( Names.named( &quot;JDBC.url&quot; ) )
                    .to( &quot;jdbc:derby://${JDBC.host}:${JDBC.port}/${JDBC.schema}&quot; );
            }

        }
        ...
        ) );</pre></div><p>That's all! When requesting the injection of <tt>JDBC.url</tt>, properties will be correctly expanded:</p><div class="source"><pre class="prettyprint">public final class JdbcConfiguration
{

    @Inject
    @Named( &quot;JDBC.url&quot; )
    private String jdbcUrl; // jdbc:derby://localhost:3306/test

    ...

}</pre></div><div class="section"><h3>${}, the <i>Apache Ant</i> variables style<a name="a_the_Apache_Ant_variables_style"></a></h3><p>Rocoto supports the well known <i>${}</i> expression to define placeholders, which scope is the whole configuration, that means that users can define some commons properties in one properties file:</p><div class="source"><pre class="prettyprint">commons.host=localhost
commons.port=8080
...</pre></div><p>then referencing them in different files:</p><div class="source"><pre class="prettyprint">ldap.host=${commons.host}
ldap.port=${commons.port}
...</pre></div></div><div class="section"><h3>Default Values<a name="Default_Values"></a></h3><p>In Java code users can retrieve a property from <tt>java.util.Properties</tt> specifying the <b>default</b> value if the input key is not present, using the <a class="externalLink" href="http://download.oracle.com/javase/6/docs/api/java/util/Properties.html#getProperty(java.lang.String, java.lang.String)">Properties#getProperty(java.lang.String, java.lang.String)</a> method.</p><p>Rocoto allows doing the same, users can specify a key using the pipe character <tt>|</tt> to separate the key name from the default value:</p><div class="source"><pre class="prettyprint">JDBC.url=jdbc:derby://${JDBC.host|localhost}:${JDBC.port|1527}/${JDBC.schema}</pre></div><p>that means if <tt>JDBC.host</tt> and <tt>JDBC.port</tt> won't be specified, they will be replaced by the default values; given the following properties:</p><div class="source"><pre class="prettyprint">JDBC.url=jdbc:derby://${JDBC.host|localhost}:${JDBC.port|1527}/${JDBC.schema}
JDBC.schema=rocoto</pre></div><p>the <tt>JDBC.url</tt> property value will be <tt>jdbc:derby://localhost:1527/rocoto</tt>.</p></div><div class="section"><h3>Add support for variables in default value (since 6.2)<a name="Add_support_for_variables_in_default_value_since_6.2"></a></h3><div class="source"><pre class="prettyprint">property=${not.found|${not.found.again|Crap!}}

# property = Crap!

not.found.again=Fallback!

# property = Fallback!</pre></div></div><div class="section"><h3>Add support for dynamic variables (since 6.2)<a name="Add_support_for_dynamic_variables_since_6.2"></a></h3><div class="source"><pre class="prettyprint">hello.en=Hi!
hello.fr=Salut !
hello.i18n=${hello.${locale|en}}

# hello.i18n = Hi!

locale=fr

# hello.i18n = Salut!</pre></div></div><div class="section"><h3>Prevent infinite loop for recursive variables (since 6.2)<a name="Prevent_infinite_loop_for_recursive_variables_since_6.2"></a></h3><div class="source"><pre class="prettyprint"># Will not thow a stack overflow
GNU=${GNU}'s Not UNIX</pre></div></div><div class="section"><h3>Add support for configuration hell and free headaches (since 6.2)<a name="Add_support_for_configuration_hell_and_free_headaches_since_6.2"></a></h3><div class="source"><pre class="prettyprint">g=2g
gg2=2
h=${${${g}4|${g}2}}
2g=gg
2g2=4
gg=${h}${4|${${2g}2}}

# gg=42</pre></div></div><div class="section"><h3>More flexible than the Spring Framework v2!<a name="More_flexible_than_the_Spring_Framework_v2"></a></h3><p>I had a not so good experience with the Spring 2 <a class="externalLink" href="http://static.springsource.org/spring/docs/2.0.2/api/org/springframework/beans/factory/config/PropertyPlaceholderConfigurer.html">PropertyPlaceholderConfigurer</a> because it forces users to centralize the properties files loading; I mean, to make things working, in the way that <i>${}</i> expressions were correctly resolved, I had to declare just one <tt>PropertyPlaceholderConfigurer</tt> for the whole context, list all the <tt>*.properties</tt> files for the all modules.</p><p>I didn't like that approach at all, it doesn't allow users to split configurations in different modules even if some keys are shared by two or more modules. Rocoto users won't have these problems at all, they can load <tt>*.properties</tt> files from different locations and obtain the same result.</p></div></div>
                  </div>
            </div>
      
    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2010-2012
                        <a href="http://www.99soft.org/">99 Software Foundation</a>.
            All Rights Reserved.      
                    
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
